<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Markdown Cleaning Demo</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: white;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            text-align: center;
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }
        
        .demo-section {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            padding: 30px;
            margin: 20px 0;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .chatbots-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 20px;
        }
        
        .chatbot-section {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .chatbot-section h3 {
            margin: 0 0 15px 0;
            font-size: 1.3rem;
            color: #fff;
        }
        
        .api-key-input {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .input-group {
            margin: 15px 0;
            text-align: left;
        }
        
        .input-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
        }
        
        .input-group input {
            width: 100%;
            padding: 12px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 14px;
            box-sizing: border-box;
        }
        
        .input-group input::placeholder {
            color: rgba(255, 255, 255, 0.6);
        }
        
        .note {
            background: rgba(255, 193, 7, 0.2);
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin: 20px 0;
            border-radius: 0 8px 8px 0;
            text-align: left;
        }
        
        @media (max-width: 768px) {
            .chatbots-container {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üßπ Markdown Cleaning Demo</h1>
        
        <div class="demo-section">
            <h2>Compare Responses With and Without Markdown Cleaning</h2>
            <p>This demo shows how the chatbot automatically removes markdown formatting to provide clean, readable responses.</p>
        </div>
        
        <div class="api-key-input">
            <h3>üîë Enter Your OpenAI API Key</h3>
            <div class="input-group">
                <label for="openai-key">OpenAI API Key:</label>
                <input 
                    type="password" 
                    id="openai-key" 
                    placeholder="Enter OpenAI API Key (sk-...)"
                    onchange="updateChatbots()"
                >
            </div>
        </div>
        
        <div class="demo-section">
            <h2>üß™ Test the Markdown Cleaning</h2>
            <p>Ask questions like "What are the benefits of AI?" or "Explain machine learning" to see the difference.</p>
            
            <div class="chatbots-container">
                <div class="chatbot-section">
                    <h3>‚úÖ With Markdown Cleaning</h3>
                    <p>Clean, readable text without formatting characters</p>
                    <div id="chatbot-clean"></div>
                </div>
                
                <div class="chatbot-section">
                    <h3>‚ùå Without Markdown Cleaning</h3>
                    <p>Raw AI response with markdown formatting</p>
                    <div id="chatbot-no-clean"></div>
                </div>
            </div>
        </div>
        
        <div class="note">
            <strong>üí° What Gets Cleaned:</strong>
            <ul>
                <li><strong>Bold formatting</strong>: <code>**text**</code> ‚Üí <code>text</code></li>
                <li><em>Italic formatting</em>: <code>*text*</code> ‚Üí <code>text</code></li>
                <li>Headers: <code># Header</code> ‚Üí <code>Header</code></li>
                <li>Code blocks: <code>```code```</code> ‚Üí <code>code</code></li>
                <li>Links: <code>[text](url)</code> ‚Üí <code>text</code></li>
            </ul>
        </div>
    </div>

    <!-- React and ReactDOM CDN -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Chatbot Component -->
    <script type="text/babel">
        // Simple chatbot component for demonstration
        function SimpleChatbot({ id, cleanMarkdown, context }) {
            const [messages, setMessages] = useState([]);
            const [inputValue, setInputValue] = useState('');
            const [isLoading, setIsLoading] = useState(false);
            
            // Function to clean markdown formatting
            const cleanMarkdownText = (text) => {
                if (!text || !cleanMarkdown) return text;
                
                return text
                    .replace(/^#{1,6}\s+/gm, '')
                    .replace(/\*\*(.*?)\*\*/g, '$1')
                    .replace(/\*(.*?)\*/g, '$1')
                    .replace(/```[\s\S]*?```/g, '')
                    .replace(/`([^`]+)`/g, '$1')
                    .replace(/\[([^\]]+)\]\([^)]+\)/g, '$1')
                    .replace(/~~(.*?)~~/g, '$1')
                    .replace(/^>\s+/gm, '')
                    .replace(/^[-*_]{3,}$/gm, '')
                    .replace(/\n\s*\n/g, '\n\n')
                    .trim();
            };
            
            const handleSubmit = async (e) => {
                e.preventDefault();
                if (!inputValue.trim() || isLoading) return;
                
                const userMessage = {
                    id: Date.now(),
                    role: 'user',
                    content: inputValue.trim(),
                    timestamp: new Date().toISOString()
                };
                
                setMessages(prev => [...prev, userMessage]);
                setInputValue('');
                setIsLoading(true);
                
                // Simulate AI response with markdown
                setTimeout(() => {
                    const aiResponse = `Here's a **comprehensive answer** to your question about "${inputValue.trim()}".

*Key points* to consider:

1. **First benefit**: This is important because it helps with efficiency
2. *Second benefit*: Another advantage is improved accuracy
3. \`Technical detail\`: Some technical information here

> **Quote**: "This is a significant improvement"

You can learn more at [our website](https://example.com) or check out \`\`\`code examples\`\`\` for implementation.

**Summary**: The overall impact is *substantial* and worth considering.`;
                    
                    const cleanResponse = cleanMarkdownText(aiResponse);
                    
                    const assistantMessage = {
                        id: Date.now() + 1,
                        role: 'assistant',
                        content: cleanResponse,
                        timestamp: new Date().toISOString()
                    };
                    
                    setMessages(prev => [...prev, assistantMessage]);
                    setIsLoading(false);
                }, 1000);
            };
            
            return (
                <div className="chatbot-container chatbot-light">
                    <div className="chat-messages">
                        {messages.map((message) => (
                            <div key={message.id} className={`chat-message ${message.role}`}>
                                <div className="message-content">
                                    {message.content}
                                </div>
                                <div className="message-timestamp">
                                    {new Date(message.timestamp).toLocaleTimeString()}
                                </div>
                            </div>
                        ))}
                        
                        {isLoading && (
                            <div className="chat-message assistant">
                                <div className="typing-indicator">
                                    <span></span><span></span><span></span>
                                </div>
                            </div>
                        )}
                    </div>
                    
                    <form onSubmit={handleSubmit} className="chat-input-form">
                        <input
                            type="text"
                            value={inputValue}
                            onChange={(e) => setInputValue(e.target.value)}
                            placeholder="Ask a question..."
                            disabled={isLoading}
                            className="chat-input"
                        />
                        <button type="submit" disabled={!inputValue.trim() || isLoading} className="send-button">
                            {isLoading ? '‚è≥' : 'üì§'}
                        </button>
                    </form>
                </div>
            );
        }
        
        // Render chatbots
        function App() {
            const apiKey = document.getElementById('openai-key').value;
            
            return (
                <div>
                    {apiKey && (
                        <>
                            <div id="chatbot-clean">
                                <SimpleChatbot 
                                    id="clean" 
                                    cleanMarkdown={true}
                                    context="You are a helpful AI assistant. Use markdown formatting in your responses to demonstrate the cleaning functionality."
                                />
                            </div>
                            <div id="chatbot-no-clean">
                                <SimpleChatbot 
                                    id="no-clean" 
                                    cleanMarkdown={false}
                                    context="You are a helpful AI assistant. Use markdown formatting in your responses to show the difference."
                                />
                            </div>
                        </>
                    )}
                </div>
            );
        }
        
        // Function to update chatbots when API key changes
        function updateChatbots() {
            ReactDOM.render(<App />, document.getElementById('chatbot-clean').parentNode);
            ReactDOM.render(<App />, document.getElementById('chatbot-no-clean').parentNode);
        }
        
        // Initial render
        ReactDOM.render(<App />, document.getElementById('chatbot-clean').parentNode);
        ReactDOM.render(<App />, document.getElementById('chatbot-no-clean').parentNode);
    </script>
    
    <!-- Include the CSS -->
    <link rel="stylesheet" href="../src/SmartChatbot.css">
</body>
</html>
